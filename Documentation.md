# FitnessBot: Техническая документация

## 1. Общее описание системы
FitnessBot — это программный комплекс на базе Telegram, предназначенный для автоматизации контроля физической активности и питания пользователя. Программа интегрируется с внешними сервисами (Google Fit, LogMeal) для сбора данных и предоставляет аналитические инструменты для отслеживания прогресса.

## 2. Архитектура решения
Проект построен по модульному принципу на языке C# (.NET) с использованием асинхронной модели программирования.

### Основные слои (Modules):
- **Core**: Ядро системы, содержащее бизнес-логику, сервисы (ActivityService, NutritionService, BmiService) и доменные сущности.
- **Infrastructure**: Слой инфраструктуры, отвечающий за доступ к данным (DataAccess) и внешние уведомления (NotificationService).
- **Scenarios**: Логика взаимодействия с пользователем через Telegram (сценарии регистрации, ввода еды, настройки целей).
- **TelegramBot**: Точка входа для взаимодействия с Telegram API, обработчики команд и фото.
- **BackgroundTasks**: Фоновые задачи для синхронизации с Google Fit и отправки напоминаний.

## 3. Ключевые компоненты и функциональность

### 3.1. Управление питанием (LogMeal)
Интеграция с API LogMeal позволяет пользователям отправлять фотографии блюд для автоматического распознавания калорий и БЖУ (белки, жиры, углеводы). Сценарий `PhotoMealGramsScenario` управляет процессом от момента загрузки фото до сохранения данных в БД.

### 3.2. Синхронизация активности (Google Fit)
Фоновая задача `GoogleFitSyncBackgroundTask` периодически запрашивает данные о шагах и активности пользователя из Google Fit API, обеспечивая актуальность информации в боте без ручного ввода.

### 3.3. Аналитика и отчеты
`ReportService` и `ChartService` генерируют визуальные отчеты (графики) и текстовые сводки о прогрессе пользователя. Бот предоставляет данные по ИМТ (BMI), потреблению калорий и выполнению дневных целей.

## 4. Схема данных
Проект использует PostgreSQL для хранения информации. Основные таблицы включают:
- `users`: Данные профиля (имя, возраст, рост, вес).
- `meal_logs`: История приемов пищи.
- `activity_logs`: Данные о физической активности.
- `user_goals`: Установленные цели по калориям и шагам.

## 5. Технологический стек
- **Язык**: C# 12 / .NET 8
- **БД**: PostgreSQL, linq2db
- **API**: Telegram Bot API, Google Fit REST API, LogMeal API
- **Библиотеки**: Telegram.Bot, Microsoft.Extensions.DependencyInjection, SkiaSharp (для графиков)

## 6. Установка и запуск
Для работы программы необходимы:
1. Токен Telegram бота.
2. API-ключи Google Fit и LogMeal.
3. Развернутая БД PostgreSQL.

Настройка производится через конфигурационный файл или переменные окружения.
